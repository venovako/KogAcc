!>@brief \b DROTR premultiplies the rows (p,q) of G by W.
PURE SUBROUTINE DROTR(M, N, G, LDG, P, Q, W, INFO)
  USE, INTRINSIC :: ISO_FORTRAN_ENV, ONLY: REAL64
  IMPLICIT NONE

  INTERFACE
     PURE SUBROUTINE DROTM(N, DX, INCX, DY, INCY, DPARAM)
       USE, INTRINSIC :: ISO_FORTRAN_ENV, ONLY: REAL64
       IMPLICIT NONE
       INTEGER, INTENT(IN) :: N, INCX, INCY
       REAL(KIND=REAL64), INTENT(INOUT) :: DX(*), DY(*)
       REAL(KIND=REAL64), INTENT(IN) :: DPARAM(5)
     END SUBROUTINE DROTM
  END INTERFACE

  INTEGER, INTENT(IN) :: M, N, LDG, P, Q
  REAL(KIND=REAL64), INTENT(INOUT) :: G(LDG,N)
  REAL(KIND=REAL64), INTENT(IN) :: W(2,2)
  INTEGER, INTENT(OUT) :: INFO
  REAL(KIND=REAL64) :: PARAM(5)

  INFO = 0
  IF ((Q .LE. P) .OR. (Q .GT. M)) INFO = -6
  IF ((P .LE. 0) .OR. (P .GE. M)) INFO = -5
  IF (LDG .LT. M) INFO = -4
  IF (N .LT. 0) INFO = -2
  IF (M .LT. 0) INFO = -1
  IF (INFO .NE. 0) RETURN
  IF (M .EQ. 0) RETURN
  IF (N .EQ. 0) RETURN

  PARAM(1) = -1.0_REAL64
  PARAM(2) = W(1,1)
  PARAM(3) = W(2,1)
  PARAM(4) = W(1,2)
  PARAM(5) = W(2,2)

  CALL DROTM(N, G(P,1), LDG, G(Q,1), LDG, PARAM)
END SUBROUTINE DROTR
